@model List<Repositories.ViewModels.Admin.NewTables>

@{
    List<String> requesterBgColor = new List<String>() { "bg-danger", "bg-success", "bg-warning", "bg-primary" };
    List<String> requesterTextColor = new List<String>() { "text-danger", "text-success", "text-warning", "text-primary" };
    List<String> requester = new List<String>() { "Business", "Patient", "Family", "Concierge"};
}

<div class="table-responsive row">
    <table class="table myTable">
        <thead>
            <tr>
                <th class="col-2 text-black">
                    Name
                </th>
                <th class="col-1 text-black">
                    Date Of Birth
                </th>
                <th class="col-1 text-black">
                    Requesters
                </th>
                <th class="col-1 text-black">
                    Requested Date
                </th>
                <th class="col-2 text-black">
                    Phone
                </th>
                <th class="col-2 text-black">
                    Address
                </th>
                <th class="col-1 text-black">
                    Notes
                </th>
                <th class="col-1 text-black">
                    Chat With
                </th>
                <th class="col-1 text-black">
                    Actions
                </th>
            </tr>
        </thead>
        <tbody class="text-white">
            @foreach(var data in Model)
            {
                <tr class="@requesterBgColor[data.Requester - 1] align-middle">
                    <td>
                        <div class="d-flex justify-content-between  align-items-center">
                            <span id="name-@data.RequestId">
                                @data.FirstName @data.LastName
                            </span>
                            <button class="bg-transparent text-white p-2 border-white">
                                <i class="bi bi-envelope-fill"></i>
                            </button>
                        </div>
                    </td>
                    <td>
                        @data.BirthDate.ToString()
                    </td>
                    <td>
                        @requester[data.Requester - 1], @data.RequesterFirstName @data.RequesterLastName
                    </td>
                    <td>
                        @data.RequestdDate
                    </td>
                    <td>
                        <button class="bg-transparent text-white p-2 border-white">
                            @data.Mobile
                        </button>
                        (Patient)
                        @if(data.Requester==1 || data.Requester==3 || data.Requester==4)
                        {
                            <button class="bg-transparent text-white p-2 border-white">
                                @data.RequesterMobile
                            </button>
                            <span>
                                (@requester[data.Requester - 1])
                            </span>
                        }
                    </td>
                    <td>
                        @data.Street, @data.City, @data.State, @data.ZipCode
                    </td>
                    <td>
                        -
                    </td>
                    <td>
                        <button class="bg-transparent text-white p-2 border-white">
                            <i class="bi bi-person"></i>
                            Provider
                        </button>
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="btn p-2 btn-secondary dropdown-toggle bg-transparent text-white border-white" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Actions
                            </button>
                            <ul class="dropdown-menu">
                                <li>
                                    <button class="dropdown-item" onclick="displayPopUp(@data.RequestId)" data-bs-target="#assignRequest" data-bs-toggle="modal">
                                        Assign Case
                                    </button>
                                </li>
                                <li>
                                    <button class="dropdown-item" onclick="displayPopUp(@data.RequestId)" data-bs-target="#cancelRequest" data-bs-toggle="modal">
                                        Cancel Case
                                    </button>
                                </li>
                                <li>
                                    <a class="dropdown-item" asp-controller="Admin" asp-action="ViewCase" asp-route-requestId="@data.RequestId">
                                        View Case
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#">
                                        View Notes
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#">
                                        Block Patient
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<div class="accordion row" id="accordionFlushExample">
    @if(Model != null)
    {
        @foreach(var data in  Model)
        {
            <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingOne">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#flush-@data.RequestId" aria-expanded="false" aria-controls="flush-collapseOne">
                        <div class="col-7">
                            <div class="mb-2">
                                @data.FirstName @data.LastName
                            </div>
                            @data.Street, @data.City, @data.State, @data.ZipCode
                        </div>
                        <div class="col-5 d-flex align-items-end mx-2 flex-column">
                            <div class="mb-1 d-flex justify-content-center mapButton">
                                <span>
                                    @requester[data.Requester - 1]
                                </span>
                                <i class="bi bi-circle-fill @requesterTextColor[data.Requester - 1] mx-1"></i>
                            </div>
                            <div class="border border-1 rounded-pill d-flex justify-content-center p-2 border-primary mapButton">
                                Map Location
                            </div>
                        </div>
                    </button>
                </h2>
                <div id="flush-@data.RequestId" class="accordion-collapse collapse" aria-labelledby="flush-headingOne"
                     data-bs-parent="#accordionFlushExample">
                    <div class="mt-3">
                        <div class="mt-3">
                            <i class="bi bi-telephone-fill rounded-circle border border-1 border-primary p-2"></i>
                            <span class="h6">
                                Date of Borth: @data.BirthDate
                            </span>
                        </div>
                        <div class="mt-3">
                            <i class="bi bi-envelope-fill rounded-circle border border-1 border-primary p-2"></i>
                            <span class="h6">
                                Email: @data.Email
                            </span>
                        </div>
                        <div class="mt-3">
                            <i class="bi bi-telephone-fill rounded-circle border border-1 border-primary p-2"></i>
                            <span class="h6">
                                Patient: @data.Mobile
                            </span>
                        </div>
                        <div class="mt-3">
                            <i class="bi bi-telephone-fill rounded-circle border border-1 border-primary p-2"></i>
                            <span class="h6">
                                Requester: @requester[data.Requester - 1], @data.RequesterFirstName @data.RequesterLastName
                            </span>
                        </div>
                    </div>
                    <div class="row mt-3 px-3">
                        <div class="px-2 col-md-4 col-sm-6 col-6">
                            <button class="w-100 bg-info text-white fw-bold" onclick="displayPopUp(@data.RequestId)" data-bs-target="#assignRequest" data-bs-toggle="modal">
                                Asign Case
                            </button>
                        </div>
                        <div class="px-2 col-md-4 col-sm-6 col-6">
                            <button class="w-100 bg-danger text-white fw-bold" onclick="displayPopUp(@data.RequestId)" data-bs-target="#cancelRequest" data-bs-toggle="modal">
                                Cancel Case
                            </button>
                        </div>
                        <div class="px-2 col-md-4 col-sm-6 col-6">
                            <button class="w-100 bg-success text-white fw-bold">
                                View Notes
                            </button>
                        </div>
                        <div class="px-2 col-md-4 col-sm-6 col-6">
                            <button class="w-100 bg-danger text-white fw-bold">
                                Block Patient
                            </button>
                        </div>
                        <div class="px-2 col-md-4 col-sm-6 col-6">
                            <button class="w-100 bg-success text-white fw-bold">
                                Email
                            </button>
                        </div>
                    </div>
                    @*<div class="d-flex justify-content-end align-items-center">
                        Chat With : 
                        <button class="bg-transparent p-2 mx-2">
                            <i class="bi bi-person"></i>
                            Admin
                        </button>
                    </div>*@
                </div>
            </div>
        }
    }
</div>
